#+TITLE: Login and Signup
#+DATE: [2019-02-06 Wed]
#+AUTHOR: Philipp Uhl

* Frontend

** Redux Interface

This component provides the states
- ~token~ :: The Basic-auth token for the API
- ~id~ :: The users ID
- ~name~ :: The users name
- ~email~ :: The users Email-Address

In order to logout a user simply delete the complete store and return
to the Login screen.

** Screens

This component provides the screens
- ~Apparts.Login~ :: A Login-page for login with username and password
- ~Apparts.Signup~ :: A Signup-page for username, password, name

** Configuration

Under the configuration name =login= the following options exist:
- ~screenAfterLogin {string}~ :: The screen to maneuver to after
     successful login
- ~screenAfterSignup {string}~ :: The screen to maneuver to after
     successful signup
- ~nameLengthMin {int}~ :: The minimum length for the username
- ~pwLengthMin {int}~ :: The minimum length for the password

Under the configuration name =lang= the following options exist:
- ~supportedLangs {[[string]]}~ :: Array with the possible languages
     to choose from. The option has to be formatted like follows:
     ~[['eng', 'US', 'English'], ['de', 'DE', 'Deutsch']]~ for the
     languages with display texts =German= and =English=, using the
     German and US American flags (=DE=, =US=) and referencing
     language-objects with names =de= and =eng=.

For using the =apparts-config= module with react native it is
necessary to use the =babel-plugin-module-resolver= module in order to
replace the =apparts-config= module project wide with a short file
that implements the function ~get~ like this:

#+BEGIN_SRC js
module.exports.get = (config) => {
  return {
    // my configs
    login: {
      screenAfterLogin: 'myApp.main',
      screenAfterSignup: 'myApp.welcome'
    }
  }[config];
};
#+END_SRC

The respective babel configuration in the file =babel.config.js= would
be:

#+BEGIN_SRC js
module.exports = {
  // ...
  "plugins": [
    ["module-resolver", {
      "alias": {
        "apparts-config": "./src/config.js",
        "apparts-react-navigation": "./node_modules/apparts-react-navigation"
      }
    }]
  ]
};
#+END_SRC

** Usage

1. To register the screens include the package =apparts-login= in your
   =src/screens/index.js= like this:

   #+BEGIN_SRC js
   export { Login, Signup } from 'apparts-login';
   #+END_SRC

2. To use the default language files import them like this in your
   =src/lang/index.js=:

   #+BEGIN_SRC js
   import * as eng from './eng';
   import * as AppartsLogin from 'apparts-login';
   const lang = { eng: {...AppartsLogin.lang.eng, ...eng.eng }};
   module.exports = lang;
   #+END_SRC

   You can partly overwrite the provided ~lang~-Object if necessary.

3. In order to start the application with a login/signup-screen:

   #+BEGIN_SRC js
   import { startApp } from './src/utils/navigation';
   // get Store s
   startApp({ startScreen: 'Apparts.Signup', store: s});
   #+END_SRC

4. It might be necessary to limit the directories from which modules
   can be imported to only the root level of =node_modules= by putting
   the following into your =webpack= configuration

   #+BEGIN_SRC js
     resolve: {
       // ...
       alias: {
         // ...
         'apparts-react-navigation': join(__dirname, './node_modules/apparts-react-navigation')
       }
     }
   #+END_SRC

5. Install peer-dependencies for frontend

   - "apparts-frontend-api": "git+ssh://git@ph-uhl.com:Apparts/apparts-frontend-api.git#semver:^1.0.0",
   - "apparts-react-native-components": "git+ssh://git@ph-uhl.com:Apparts/apparts-react-native-components.git#semver:^1.0.0",
   - "apparts-react-navigation": "git+ssh://git@ph-uhl.com:Apparts/apparts-react-navigation.git#semver:^1.0.0",
   - "apparts-redux": "git+ssh://git@ph-uhl.com:Apparts/apparts-redux.git#semver:^1.0.0",
   - "base-64": "^0.1.0",
   - "react": "^16.8.1",
   - "react-native": "^0.58.4",
